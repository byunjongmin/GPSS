function [finalSedThickGrdObj,finalBedElevGrdObj] = ToGRIDobj(majorOutputs)
%% To convert the GPSS output final result to TopoToolbox grid object 

finalResultNo = majorOutputs.totalExtractTimesNo + 1;
dX = majorOutputs.dX;
dY = majorOutputs.dX;
X = majorOutputs.X;
X_INI = majorOutputs.X_INI;
Y = majorOutputs.Y;
Y_INI = majorOutputs.Y_INI;

finalSedThick = majorOutputs.sedimentThick(:,:,finalResultNo);
finalBedElev = majorOutputs.bedrockElev(:,:,finalResultNo);

finalSedThickGrdObj = GRIDobj([]); % creates an empty instance of GRIDobj
finalBedElevGrdObj = GRIDobj([]); % creates an empty instance of GRIDobj

finalSedThickGrdObj.Z = finalSedThick(Y_INI:Y+1,X_INI:X+1);
finalSedThickGrdObj.cellsize = dX;
finalSedThickGrdObj.refmat = double([0,-dY; dX,0; dX*0.5,dY*Y+dY*0.5]);
finalSedThickGrdObj.size = [Y,X];
finalSedThickGrdObj.name = 'sedThick401';
finalSedThickGrdObj.zunit = [];
finalSedThickGrdObj.xyunit = [];
finalSedThickGrdObj.georef.SpatialRef.RasterInterpretation = 'cells';
finalSedThickGrdObj.georef.SpatialRef.XIntrinsicLimits = [0.5,X+0.5];
finalSedThickGrdObj.georef.SpatialRef.YIntrinsicLimits = [0.5,Y+0.5];
finalSedThickGrdObj.georef.SpatialRef.CellExtentInWorldX = dX;
finalSedThickGrdObj.georef.SpatialRef.CellExtentInWorldY = dY;
finalSedThickGrdObj.georef.SpatialRef.XWorldLimits = [0,dX*X];
finalSedThickGrdObj.georef.SpatialRef.YWorldLimits = [0,dY*Y];
finalSedThickGrdObj.georef.SpatialRef.RasterSize = [Y,X];
finalSedThickGrdObj.georef.SpatialRef.ColumnsStartFrom = 'north';
finalSedThickGrdObj.georef.SpatialRef.RowsStartFrom = 'west';
finalSedThickGrdObj.georef.SpatialRef.RasterExtentInWorldX = dX*X;
finalSedThickGrdObj.georef.SpatialRef.RasterExtentInWorldY = dY*Y;
finalSedThickGrdObj.georef.SpatialRef.TransformationType = 'rectlinear';
finalSedThickGrdObj.georef.SpatialRef.CoordinateSystemType = 'planar';
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.Name = "WGS 84 / UTM zone 11N";
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Name = "WGS 84";
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Datum = "World Geodetic System 1984";
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.Code = 7030;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.Name = 'WGS 84';
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.LengthUnit = 'meter';
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.SemimajorAxis = 6378137;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.SemiminorAxis = 6.356752314245179e+06;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.InverseFlattening = 298.2572;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.Eccentricity = 0.0818;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.Flattening = 0.0034;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.ThirdFlattening = 0.0017;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.MeanRadius = 6.371008771415059e+06;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.SurfaceArea = 5.100656217240886e+14;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.Volume = 1.083207319801408e+21;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.PrimeMeridian = 0;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.AngleUnit = 'degree';
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.ProjectionMethod ='Transverse Mercator';
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.LengthUnit = 'meter';
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.ProjectionParameters.LatitudeOfNaturalOrigin = 0;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.ProjectionParameters.LongitudeOfNaturalOrigin = -117;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.ProjectionParameters.ScaleFactorAtNaturalOrigin = 0.9996;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.ProjectionParameters.FalseEasting = 500000;
finalSedThickGrdObj.georef.SpatialRef.ProjectedCRS.ProjectionParameters.FalseNorthing = 0;
finalSedThickGrdObj.georef.GeoKeyDirectoryTag.GTModelTypeGeoKey = 1;
finalSedThickGrdObj.georef.GeoKeyDirectoryTag.GTRasterTypeGeoKey = 1;
finalSedThickGrdObj.georef.GeoKeyDirectoryTag.GTCitationGeoKey = 'PCS Name = WGS_84_UTM_zone_11N';
finalSedThickGrdObj.georef.GeoKeyDirectoryTag.GeogCitationGeoKey = 'GCS_WGS_1984';
finalSedThickGrdObj.georef.GeoKeyDirectoryTag.GeogAngularUnitsGeoKey = 9102;
finalSedThickGrdObj.georef.GeoKeyDirectoryTag.ProjectedCSTypeGeoKey = 32611;
finalSedThickGrdObj.georef.GeoKeyDirectoryTag.ProjLinearUnitsGeoKey = 9001;
finalSedThickGrdObj.georef.mstruct.mapprojection = 'tranmerc';
finalSedThickGrdObj.georef.mstruct.zone = [];
finalSedThickGrdObj.georef.mstruct.angleunits = 'degrees';
finalSedThickGrdObj.georef.mstruct.aspect = 'normal';
finalSedThickGrdObj.georef.mstruct.falsenorthing = 0;
finalSedThickGrdObj.georef.mstruct.falseeasting = 500000;
finalSedThickGrdObj.georef.mstruct.fixedorient = [];
finalSedThickGrdObj.georef.mstruct.geoid = [6378137,0.081819190842621];
finalSedThickGrdObj.georef.mstruct.maplatlimit = [-80,80];
finalSedThickGrdObj.georef.mstruct.maplonlimit = [-137,-97];
finalSedThickGrdObj.georef.mstruct.mapparallels = [];
finalSedThickGrdObj.georef.mstruct.nparallels = 0;
finalSedThickGrdObj.georef.mstruct.origin = [0,-117,0];
finalSedThickGrdObj.georef.mstruct.scalefactor = 0.9996;
finalSedThickGrdObj.georef.mstruct.trimlat = [-80,80];
finalSedThickGrdObj.georef.mstruct.trimlon = [-20,20];
finalSedThickGrdObj.georef.mstruct.frame = 'off';
finalSedThickGrdObj.georef.mstruct.ffill = 100;
finalSedThickGrdObj.georef.mstruct.fedgecolor = [0.15,0.15,0.15];
finalSedThickGrdObj.georef.mstruct.ffacecolor = 'none';
finalSedThickGrdObj.georef.mstruct.flatlimit = [-80,80];
finalSedThickGrdObj.georef.mstruct.flinewidth = 2;
finalSedThickGrdObj.georef.mstruct.flonlimit = [-20,20];
finalSedThickGrdObj.georef.mstruct.grid = 'off';
finalSedThickGrdObj.georef.mstruct.galtitude = Inf;
finalSedThickGrdObj.georef.mstruct.gcolor = [0.15,0.15,0.15];
finalSedThickGrdObj.georef.mstruct.glinestyle = ':';
finalSedThickGrdObj.georef.mstruct.glinewidth = 0.5;
finalSedThickGrdObj.georef.mstruct.mlineexception = [];
finalSedThickGrdObj.georef.mstruct.mlinefill = 100;
finalSedThickGrdObj.georef.mstruct.mlinelimit = [];
finalSedThickGrdObj.georef.mstruct.mlinelocation = 30;
finalSedThickGrdObj.georef.mstruct.mlinevisible = 'on';
finalSedThickGrdObj.georef.mstruct.plineexception = [];
finalSedThickGrdObj.georef.mstruct.plinefill = 100;
finalSedThickGrdObj.georef.mstruct.plinelimit = [];
finalSedThickGrdObj.georef.mstruct.plinelocation = 15;
finalSedThickGrdObj.georef.mstruct.plinevisible = 'on';
finalSedThickGrdObj.georef.mstruct.fontangle = 'normal';
finalSedThickGrdObj.georef.mstruct.fontcolor = [0.15,0.15,0.15];
finalSedThickGrdObj.georef.mstruct.fontname = 'Helvetica';
finalSedThickGrdObj.georef.mstruct.fontsize = 10;
finalSedThickGrdObj.georef.mstruct.fontunits = 'points';
finalSedThickGrdObj.georef.mstruct.fontweight = 'normal';
finalSedThickGrdObj.georef.mstruct.labelformat = 'compass';
finalSedThickGrdObj.georef.mstruct.labelrotation = 'off';
finalSedThickGrdObj.georef.mstruct.labelunits = 'degrees';
finalSedThickGrdObj.georef.mstruct.meridianlabel = 'off';
finalSedThickGrdObj.georef.mstruct.mlabellocation = 30;
finalSedThickGrdObj.georef.mstruct.mlabelparallel = 80;
finalSedThickGrdObj.georef.mstruct.mlabelround = 0;
finalSedThickGrdObj.georef.mstruct.parallellabel = 'off';
finalSedThickGrdObj.georef.mstruct.plabellocation = 15;
finalSedThickGrdObj.georef.mstruct.plabelmeridian = -137;
finalSedThickGrdObj.georef.mstruct.plabelround = 0;

finalBedElevGrdObj.Z = finalBedElev(Y_INI:Y+1,X_INI:X+1);
finalBedElevGrdObj.cellsize = dX;
finalBedElevGrdObj.refmat = double([0,-dY; dX,0; dX*0.5,dY*Y+dY*0.5]);
finalBedElevGrdObj.size = [Y,X];
finalBedElevGrdObj.name = 'bedElev401';
finalBedElevGrdObj.zunit = [];
finalBedElevGrdObj.xyunit = [];
finalBedElevGrdObj.georef.SpatialRef.RasterInterpretation = 'cells';
finalBedElevGrdObj.georef.SpatialRef.XIntrinsicLimits = [0.5,X+0.5];
finalBedElevGrdObj.georef.SpatialRef.YIntrinsicLimits = [0.5,Y+0.5];
finalBedElevGrdObj.georef.SpatialRef.CellExtentInWorldX = dX;
finalBedElevGrdObj.georef.SpatialRef.CellExtentInWorldY = dY;
finalBedElevGrdObj.georef.SpatialRef.XWorldLimits = [0,dX*X];
finalBedElevGrdObj.georef.SpatialRef.YWorldLimits = [0,dY*Y];
finalBedElevGrdObj.georef.SpatialRef.RasterSize = [Y,X];
finalBedElevGrdObj.georef.SpatialRef.ColumnsStartFrom = 'north';
finalBedElevGrdObj.georef.SpatialRef.RowsStartFrom = 'west';
finalBedElevGrdObj.georef.SpatialRef.RasterExtentInWorldX = dX*X;
finalBedElevGrdObj.georef.SpatialRef.RasterExtentInWorldY = dY*Y;
finalBedElevGrdObj.georef.SpatialRef.TransformationType = 'rectlinear';
finalBedElevGrdObj.georef.SpatialRef.CoordinateSystemType = 'planar';
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.Name = "WGS 84 / UTM zone 11N";
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Name = "WGS 84";
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Datum = "World Geodetic System 1984";
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.Code = 7030;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.Name = 'WGS 84';
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.LengthUnit = 'meter';
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.SemimajorAxis = 6378137;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.SemiminorAxis = 6.356752314245179e+06;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.InverseFlattening = 298.2572;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.Eccentricity = 0.0818;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.Flattening = 0.0034;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.ThirdFlattening = 0.0017;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.MeanRadius = 6.371008771415059e+06;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.SurfaceArea = 5.100656217240886e+14;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.Spheroid.Volume = 1.083207319801408e+21;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.PrimeMeridian = 0;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.GeographicCRS.AngleUnit = 'degree';
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.ProjectionMethod ='Transverse Mercator';
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.LengthUnit = 'meter';
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.ProjectionParameters.LatitudeOfNaturalOrigin = 0;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.ProjectionParameters.LongitudeOfNaturalOrigin = -117;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.ProjectionParameters.ScaleFactorAtNaturalOrigin = 0.9996;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.ProjectionParameters.FalseEasting = 500000;
finalBedElevGrdObj.georef.SpatialRef.ProjectedCRS.ProjectionParameters.FalseNorthing = 0;
finalBedElevGrdObj.georef.GeoKeyDirectoryTag.GTModelTypeGeoKey = 1;
finalBedElevGrdObj.georef.GeoKeyDirectoryTag.GTRasterTypeGeoKey = 1;
finalBedElevGrdObj.georef.GeoKeyDirectoryTag.GTCitationGeoKey = 'PCS Name = WGS_84_UTM_zone_11N';
finalBedElevGrdObj.georef.GeoKeyDirectoryTag.GeogCitationGeoKey = 'GCS_WGS_1984';
finalBedElevGrdObj.georef.GeoKeyDirectoryTag.GeogAngularUnitsGeoKey = 9102;
finalBedElevGrdObj.georef.GeoKeyDirectoryTag.ProjectedCSTypeGeoKey = 32611;
finalBedElevGrdObj.georef.GeoKeyDirectoryTag.ProjLinearUnitsGeoKey = 9001;
finalBedElevGrdObj.georef.mstruct.mapprojection = 'tranmerc';
finalBedElevGrdObj.georef.mstruct.zone = [];
finalBedElevGrdObj.georef.mstruct.angleunits = 'degrees';
finalBedElevGrdObj.georef.mstruct.aspect = 'normal';
finalBedElevGrdObj.georef.mstruct.falsenorthing = 0;
finalBedElevGrdObj.georef.mstruct.falseeasting = 500000;
finalBedElevGrdObj.georef.mstruct.fixedorient = [];
finalBedElevGrdObj.georef.mstruct.geoid = [6378137,0.081819190842621];
finalBedElevGrdObj.georef.mstruct.maplatlimit = [-80,80];
finalBedElevGrdObj.georef.mstruct.maplonlimit = [-137,-97];
finalBedElevGrdObj.georef.mstruct.mapparallels = [];
finalBedElevGrdObj.georef.mstruct.nparallels = 0;
finalBedElevGrdObj.georef.mstruct.origin = [0,-117,0];
finalBedElevGrdObj.georef.mstruct.scalefactor = 0.9996;
finalBedElevGrdObj.georef.mstruct.trimlat = [-80,80];
finalBedElevGrdObj.georef.mstruct.trimlon = [-20,20];
finalBedElevGrdObj.georef.mstruct.frame = 'off';
finalBedElevGrdObj.georef.mstruct.ffill = 100;
finalBedElevGrdObj.georef.mstruct.fedgecolor = [0.15,0.15,0.15];
finalBedElevGrdObj.georef.mstruct.ffacecolor = 'none';
finalBedElevGrdObj.georef.mstruct.flatlimit = [-80,80];
finalBedElevGrdObj.georef.mstruct.flinewidth = 2;
finalBedElevGrdObj.georef.mstruct.flonlimit = [-20,20];
finalBedElevGrdObj.georef.mstruct.grid = 'off';
finalBedElevGrdObj.georef.mstruct.galtitude = Inf;
finalBedElevGrdObj.georef.mstruct.gcolor = [0.15,0.15,0.15];
finalBedElevGrdObj.georef.mstruct.glinestyle = ':';
finalBedElevGrdObj.georef.mstruct.glinewidth = 0.5;
finalBedElevGrdObj.georef.mstruct.mlineexception = [];
finalBedElevGrdObj.georef.mstruct.mlinefill = 100;
finalBedElevGrdObj.georef.mstruct.mlinelimit = [];
finalBedElevGrdObj.georef.mstruct.mlinelocation = 30;
finalBedElevGrdObj.georef.mstruct.mlinevisible = 'on';
finalBedElevGrdObj.georef.mstruct.plineexception = [];
finalBedElevGrdObj.georef.mstruct.plinefill = 100;
finalBedElevGrdObj.georef.mstruct.plinelimit = [];
finalBedElevGrdObj.georef.mstruct.plinelocation = 15;
finalBedElevGrdObj.georef.mstruct.plinevisible = 'on';
finalBedElevGrdObj.georef.mstruct.fontangle = 'normal';
finalBedElevGrdObj.georef.mstruct.fontcolor = [0.15,0.15,0.15];
finalBedElevGrdObj.georef.mstruct.fontname = 'Helvetica';
finalBedElevGrdObj.georef.mstruct.fontsize = 10;
finalBedElevGrdObj.georef.mstruct.fontunits = 'points';
finalBedElevGrdObj.georef.mstruct.fontweight = 'normal';
finalBedElevGrdObj.georef.mstruct.labelformat = 'compass';
finalBedElevGrdObj.georef.mstruct.labelrotation = 'off';
finalBedElevGrdObj.georef.mstruct.labelunits = 'degrees';
finalBedElevGrdObj.georef.mstruct.meridianlabel = 'off';
finalBedElevGrdObj.georef.mstruct.mlabellocation = 30;
finalBedElevGrdObj.georef.mstruct.mlabelparallel = 80;
finalBedElevGrdObj.georef.mstruct.mlabelround = 0;
finalBedElevGrdObj.georef.mstruct.parallellabel = 'off';
finalBedElevGrdObj.georef.mstruct.plabellocation = 15;
finalBedElevGrdObj.georef.mstruct.plabelmeridian = -137;
finalBedElevGrdObj.georef.mstruct.plabelround = 0;
